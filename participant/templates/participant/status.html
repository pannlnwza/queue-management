<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Queue Status</title>
</head>
<body>
    <h1>Queue Status for {{ participant.name }}</h1>

    <h2>Queue: {{ queue.name }}</h2>

    <h3>Queue: <span id="queueName"></span></h3>
    <p>Participant: <span id="participantName"></span></p>
    <p>Position: <span id="position"></span></p>
    <p>Estimated Wait Time: <span id="waitTime"></span></p>

<script>
        const eventSource = new EventSource('/status/{{ participant.code }}/sse');

        eventSource.onmessage = function(event) {
            try {
                const data = JSON.parse(event.data);
                console.log("Received data:", data);

                // Update each part of the page as data is received
                document.getElementById('queueName').innerText = data.queue_name;
                document.getElementById('participantName').innerText = data.participant[0].name;
                document.getElementById('position').innerText = data.participant[0].position;
                document.getElementById('waitTime').innerText = data.participant[0].estimated_wait_time;
            } catch (error) {
                console.error("Error parsing JSON data:", error);
            }
        };

        eventSource.onerror = function(error) {
            console.error("Error in SSE connection:", error);
        };
    </script>



</body>
</html>
